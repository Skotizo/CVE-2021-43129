# CVE-2021-43129
## Vulnerability in version 20.21.7 of D2L Learning Management System(LMS)
### Vulnerability Type:
CWE-284: Incorrect Access Control
### Vendor of Product:
Desire2Learn/D2L
### Affected Product Code Base:
Learning Management System (LMS) - 20.21.7
### Affected Component:
Quizzing's disable right click function
### Attack Type:
Remote
### Impact Escalation of Privileges:
True
### Attack Vectors:
The quiz taker can remove "&ispriv=&drc=1" from the URL, reload, and have full access to copy and paste.
# Methodology
While taking quizzes with the advanced property "Disable right click" enabled, I found it can disabled by removing data from the GET request. The "Disable Right Click" function is used to prevent users from the options provided when right clicking as well as prevent common operator system short cuts. Altering the GET request can allow users to copy and paste quiz text and print the contents of the quiz. This bypass can disable "Disable Right Click" function completely. This vulnerability compromises the integrity of the platform because it could be used to cheat or upload tests online. This data should not be sent by the client/user to confirm whether the control should be enabled or not. 
# Proof of Concept
After starting a quiz with the "Disable right click" control enable, the users search bar will contain this highlighted data. The quizzes "Disable right click" control acts as intended at its current state.
![1](https://github.com/Skotizo/CVE-2021-43129/blob/main/example/1.png)
The quizzes "Disable right click" control acts as intended in its current state. When using CRTL+P results in this popup message.

![2](https://github.com/Skotizo/CVE-2021-43129/blob/main/example/2.png)

If the quiz taker to remove "&ispriv=&drc=1" and reload the page, the user now has print access and copy and paste access via keyboard controls.(CRTL+P,CRTL+C, and CRTL+V)
![3](https://github.com/Skotizo/CVE-2021-43129/blob/main/example/3.png)

The ou and qi elements GET request data were removed because they are personally identifying and does not effect the vulnerability. I disclosed this vulnerability privately and gave time to remediate in order to strengthen the integrity of the D2L's LMS application. 
# Timeline 
Initial Disclosure - 08/10/2021

Acknowledged Vulnerability - 08/11/2021

Payment Recieved for Disclosure - 09/10/2021

Public Disclosure - 4/15/2022
