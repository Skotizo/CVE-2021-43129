# CVE-2021-43129
## Vulnerability in D2L Brightspace’s Learning Management System(LMS) 
### Vulnerability Type:
>CWE-284: Improper Access Control
### Vendor of Product:
>Desire2Learn/D2L
### Affected Product Code Base:
>D2L Brightspace’s Learning Management System(LMS) 
>>Tested version: 20.21.7

https://www.d2l.com/learning-management-system-lms/

D2L announced that the  "Disable Right Click" setting be retired in August 2022.
https://community.brightspace.com/s/article/retirement-notice-disable-right-click
### Affected Component:
>Quizzing's "Disable Right Click" setting
### Attack Type:
>Remote
### Impact Escalation of Privileges:
>True
### Attack Vectors:
>The quiz taker can remove "&ispriv=&drc=1" from the URL, reload, and have full access to copy and paste and print
# Description 
A bypass exists for D2L Brightspace’s “Disable Right Click” option in the quizzing feature, which allows a quiz-taker to access print and copy functionality via the browser’s right click menu even when “Disable Right Click” is enabled on the quiz.
# Methodology
While taking quizzes with the advanced property "Disable right click" enabled, I found it can disabled by removing data from the GET request. The "Disable Right Click" function is used to prevent users from the options provided when right clicking as well as prevent common operator system short cuts. Altering the GET request can allow users to copy and paste quiz text and print the contents of the quiz. This bypass can disable "Disable Right Click" function completely. This vulnerability compromises the integrity of the platform because it could be used to cheat or upload tests online. This data should not be sent by the client/user to confirm whether the control should be enabled or not. 
# Proof of Concept
After starting a quiz with the "Disable right click" control enable, the users search bar will contain this highlighted data.
![1](https://github.com/Skotizo/CVE-2021-43129/blob/main/example/1.png)
The quizzes "Disable right click" control acts as intended in its current state. When using CRTL+P results in this popup message.

![2](https://github.com/Skotizo/CVE-2021-43129/blob/main/example/2.png)

If the quiz taker to remove "&ispriv=&drc=1" and reloads the page, the user now has print access and copy and paste access via keyboard controls.(CRTL+P,CRTL+C, and CRTL+V)
![3](https://github.com/Skotizo/CVE-2021-43129/blob/main/example/3.png)

The ou and qi elements GET request data were removed because they are personally identifying and does not effect the vulnerability. I disclosed this vulnerability privately and gave time to remediate in order to strengthen the integrity of the D2L's LMS application. 
***
## Simplified POC

The request to load the quiz with the "Disable Right click" function enabled.

`https://domain.com/d2l/lms/quizzing/user/attempt/quiz_start_frame_auto.d2l?ou=123456*&isprv=&drc=1*&qi=123456&cfql=0&dnb=0@fromQB=0`

The request to load the quiz and bypass the "Disable Right click" function.

`https://domain.com/d2l/lms/quizzing/user/attempt/quiz_start_frame_auto.d2l?ou=123456&qi=123456&cfql=0&dnb=0@fromQB=0`

# Timeline 
Initial Disclosure - 08/10/2021

Acknowledged Vulnerability - 08/11/2021

Payment Recieved for Disclosure - 09/10/2021

Public Disclosure - 4/15/2022

CVE updated by organization - 4/19/2022

CVE update request sent to organization to change the descripton and CWE based on D2L suggestions - 4/19/2022
